elasticsearch:
  image: dockerfile/elasticsearch
  expose:
    - "9200"
    - "9300"
  volumes:
    - deploy/data/elasticsearch:/data/data
    - deploy/logs/elasticsearch:/data/log
nginx:
  image: dockerfile/nginx
  domainname: subman.io
  links:
    - web
  volumes:
    - deploy/config/nginx:/etc/nginx/sites-enabled
    - deploy/logs/nginx:/var/log/nginx
  volumes_from:
    - web
  ports:
    - "8080:80"
web:
  image: nvbn/subman
  expose:
    - "3000"
  links:
    - elasticsearch
  command: bash deploy/scripts/run_web.sh
  environment:
    DB_HOST: "http://elasticsearch:9200"
    INDEX_NAME: "subman7"
    IS_DEBUG: "false"
parser:
  image: nvbn/subman
  links:
    - elasticsearch
  command: bash deploy/scripts/run_parser.sh
  environment:
    DB_HOST: "http://elasticsearch:9200"
    INDEX_NAME: "subman7"
    IS_DEBUG: "false"
